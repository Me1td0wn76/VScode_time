# VSCode 使用時間トラッカー

Visual Studio Code の使用時間を自動的に監視・記録し、トータル使用時間を表示するWindowsアプリケーションです。

## 機能

- **プロセス監視**: Code.exe（VSCode）のプロセスを60秒間隔で監視
- **時間記録**: VSCodeの起動・終了時刻をJSONファイルに保存
- **使用時間計算**: 記録されたログから合計使用時間と今日の使用時間を計算
- **リアルタイム表示**: 合計時間と今日の使用時間をリアルタイムで表示
- **タスクトレイ常駐**: 最小化してバックグラウンドで動作可能
- **自動更新**: アプリ起動時に即座にトータル時間を表示

## 使用方法

### 1. ビルド
```bash
dotnet build VscodeUsageTracker.csproj
```

### 2. 実行
```bash
dotnet run --project VscodeUsageTracker.csproj
```

または、ビルド後の実行ファイルを直接実行：
```bash
.\bin\Debug\net8.0-windows\VscodeUsageTracker.exe
```

### 3. 操作方法

- **メイン画面**: 合計使用時間と今日の使用時間が表示されます
- **最小化**: 「最小化してトレイに格納」ボタンでタスクトレイに常駐
- **復帰**: タスクトレイアイコンをダブルクリックまたは右クリックメニューから「表示」
- **終了**: メイン画面の「終了」ボタンまたはタスクトレイの右クリックメニューから「終了」

## ファイル構成

- `Program.cs` - アプリケーションのエントリーポイント
- `MainForm.cs` - メインフォームとUI処理
- `VsCodeMonitor.cs` - VSCodeプロセス監視とログ記録
- `log/vscode_usage.json` - 使用時間ログファイル（自動生成）

## ログファイル形式

使用時間は以下のJSON形式で記録されます：

```json
[
  {
    "EventType": "Start",
    "Timestamp": "2025-07-05T10:00:00.000Z"
  },
  {
    "EventType": "End", 
    "Timestamp": "2025-07-05T12:30:00.000Z"
  }
]
```

## 動作環境

- Windows 10/11
- .NET 8.0 Runtime
- Visual Studio Code（監視対象）

## 注意事項

- VSCodeのプロセス名「Code.exe」を監視対象としています
- アプリケーションが起動していない間のVSCode使用時間は記録されません
- ログファイルは自動的に作成されますが、手動で削除・編集することも可能です
- システム時刻が変更された場合、正確な時間計算ができない場合があります

## トラブルシューティング

### VSCodeが検出されない場合
- VSCodeが正常にインストールされているか確認
- タスクマネージャーで「Code.exe」プロセスが存在するか確認
- 管理者権限で実行してみる

### ログファイルが作成されない場合
- アプリケーションの実行ディレクトリに書き込み権限があるか確認
- アンチウイルスソフトがファイル作成をブロックしていないか確認

## カスタマイズ

監視間隔やログファイルの場所は、`VsCodeMonitor.cs`内の定数を変更することで調整できます：

```csharp
private const int CheckIntervalMs = 60000; // 監視間隔（ミリ秒）
```
