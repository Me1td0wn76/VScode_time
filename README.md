# VSCode 使用時間トラッカー

Visual Studio Code の使用時間を自動的に監視・記録し、**完全修正されたモダンUI**と**見やすい時間表示**でトータル使用時間を可視化するWindowsアプリケーションです。

## ✅ 最終修正（v2.1）

- **🎯 レイアウト完全修正**: Dockスタイルを廃止し、絶対位置指定に変更
- **� 確実な表示**: 統計パネルを明示的に位置とサイズを指定して配置
- **🔧 重なり問題解決**: ヘッダー（80px）の下に統計パネルを正確に配置
- **📱 全体表示保証**: すべての統計情報が確実に表示される

## 🎉 v2.1の修正

- **� レイアウト修正**: ヘッダーと統計カードの重なり問題を解決
- **📱 表示改善**: 合計時間が正しく表示されるように修正
- **🎨 スペーシング最適化**: 上下のマージンを適切に調整

## 🔥 v2.0の主要機能

- **🎨 モダンUI**: ダークテーマのサイドパネルと見やすいカード形式表示
- **📊 グラフ表示**: 日別・時間別の使用パターンをグラフで可視化
- **📈 詳細統計**: 週平均、最長セッション、総セッション数など
- **📁 自動ログ作成**: logディレクトリとファイルを自動生成
- **🎯 統計カード**: 4つの重要な指標をカード形式で表示

## 🔥 主要機能

- **プロセス監視**: Code.exe（VSCode）のプロセスを60秒間隔で監視
- **時間記録**: VSCodeの起動・終了時刻をJSONファイルに保存
- **リアルタイム表示**: 合計時間と今日の使用時間をリアルタイム表示
- **使用パターン分析**: 日別・時間別の使用傾向をグラフで表示
- **詳細統計**: 週平均、最長セッション、アクティブな日など
- **タスクトレイ常駐**: 最小化してバックグラウンドで動作
- **自動ログ管理**: 初回起動時にログディレクトリとファイルを自動作成

## 使用方法

### 方法1: 最新バージョン（v2.1 推奨）- 完全修正版
```bash
# 最新版をパブリッシュ
dotnet publish VscodeUsageTracker.csproj -c Release -r win-x64 --self-contained true -p:PublishSingleFile=true -o publish_v2_final

# 実行（.NETランタイムのインストール不要）
.\publish_v2_final\VscodeUsageTracker.exe
```

または、`publish_v2_final\start.bat`をダブルクリックで実行

### 方法2: 開発時（.NETランタイム必要）

#### 1. ビルド
```bash
dotnet build VscodeUsageTracker.csproj
```

#### 2. 実行
```bash
dotnet run --project VscodeUsageTracker.csproj
```

または、ビルド後の実行ファイルを直接実行：
```bash
.\bin\Debug\net8.0-windows\VscodeUsageTracker.exe
```

### 3. 操作方法

#### 🖥️ メイン画面
- **サイドパネル**: 合計時間、今日の使用時間、VSCodeの実行状態を表示
- **ダッシュボードタブ**: 詳細統計（週平均、最長セッション、総セッション数など）
- **日別グラフタブ**: 過去30日間の日別使用時間をバーグラフで表示
- **時間別パターンタブ**: 24時間の使用パターンをグラフで表示

#### 🔄 操作
- **最小化**: 「トレイに最小化」ボタンでタスクトレイに常駐
- **復帰**: タスクトレイアイコンをダブルクリックまたは右クリックメニューから「表示」
- **終了**: サイドパネルの「終了」ボタンまたはタスクトレイの右クリックメニューから「終了」

#### 📊 グラフ機能
- **日別グラフ**: 過去30日間の使用時間トレンド
- **時間別グラフ**: 1日の中でVSCodeをよく使う時間帯を分析
- **リアルタイム更新**: 30秒ごとにグラフとデータを自動更新

## ファイル構成

- `Program.cs` - アプリケーションのエントリーポイント
- `ModernMainForm.cs` - モダンUIとグラフ表示機能
- `MainForm.cs` - 旧バージョンのシンプルUI（v1.0）
- `VsCodeMonitor.cs` - VSCodeプロセス監視とログ記録、統計計算
- `log/vscode_usage.json` - 使用時間ログファイル（自動生成）

## 📊 統計情報

アプリケーションは以下の統計情報を提供します：

- **合計使用時間**: 全期間の累計使用時間
- **今日の使用時間**: 当日の使用時間
- **週平均**: 過去7日間の平均使用時間
- **最長セッション**: 最も長い連続使用時間
- **総セッション数**: VSCodeを起動した回数
- **最もアクティブな日**: 最も使用時間が長かった日

## ログファイル形式

使用時間は以下のJSON形式で記録されます：

```json
[
  {
    "EventType": "Start",
    "Timestamp": "2025-07-05T10:00:00.000Z"
  },
  {
    "EventType": "End", 
    "Timestamp": "2025-07-05T12:30:00.000Z"
  }
]
```

## 動作環境

### 自己完結版（publish フォルダ）
- Windows 10/11（x64）
- **追加のランタイムインストール不要**
- Visual Studio Code（監視対象）

### 開発版
- Windows 10/11
- .NET 8.0 Runtime
- Visual Studio Code（監視対象）

## 注意事項

- VSCodeのプロセス名「Code.exe」を監視対象としています
- アプリケーションが起動していない間のVSCode使用時間は記録されません
- ログファイルは自動的に作成されますが、手動で削除・編集することも可能です
- システム時刻が変更された場合、正確な時間計算ができない場合があります

## トラブルシューティング

### VSCodeが検出されない場合
- VSCodeが正常にインストールされているか確認
- タスクマネージャーで「Code.exe」プロセスが存在するか確認
- 管理者権限で実行してみる

### ログファイルが作成されない場合
- アプリケーションの実行ディレクトリに書き込み権限があるか確認
- アンチウイルスソフトがファイル作成をブロックしていないか確認

## カスタマイズ

監視間隔やログファイルの場所は、`VsCodeMonitor.cs`内の定数を変更することで調整できます：

```csharp
private const int CheckIntervalMs = 60000; // 監視間隔（ミリ秒）
```
